import{l as n,Q as i,P as E}from"./app-pebjqkCD.js";import{c as h,b as c,d as v,s as _}from"./index.esm-C_1aiQ0x.js";import{e as R}from"./yup-locales.esm-DRsOkZ6u.js";function I(){const u=n({user_id:0,trip_id:0,seats_reserved:null,reservation_date:null,check_in:null}),d=n([]),p=h().shape({user_id:c().required("El campo usuario es requerido").positive("El ID del usuario debe ser un número positivo").integer("El ID del usuario debe ser un número entero"),trip_id:c().required("El campo viaje es requerido").positive("El ID del viaje debe ser un número positivo").integer("El ID del viaje debe ser un número entero"),seats_reserved:c().required("El campo asientos es requerido").positive("El número de asientos reservados debe ser mayor que 0").integer("El número de asientos debe ser un número entero"),reservation_date:v().required("La fecha de reserva es requerida").min(new Date,"La fecha de reserva no puede ser en el pasado"),check_in:v().nullable(),total_price:c().required("El precio total es requerido").positive("El precio total debe ser mayor que 0").min(.01,"El precio total debe ser mayor que 0,01")});_(R);const r=n(!1),s=E("$swal"),t=n({}),m=async()=>{r.value||(r.value=!0,t.value={},i.get("/api/reserves/").then(a=>{console.log("Respuesta API mostrando reservas: ",a.data.data),d.value=a.data.data}).catch(a=>{var e;(e=a.response)!=null&&e.data&&(t.value=a.response.data.errors,console.log(t.value))}).finally(()=>r.value=!1))},f=async(a,e)=>{r.value||(r.value=!0,t.value={},i.get("/api/reserves/"+a+"/"+e).then(o=>{console.log("Respuesta API get: ",o.data.data),u.value=o.data.data}).catch(o=>{if(console.error("Error creando la reserva:",o),o.response)switch(o.response.status){case 404:o.response.data.message&&s({icon:"error",title:"Error",text:o.response.data.message});break;default:s({icon:"error",title:"Error",text:"Ha ocurrido un error al crear la reserva"})}}).finally(()=>r.value=!1))},g=async a=>{r.value||(r.value=!0,t.value={},a.value.reservation_date&&(a.value.reservation_date=l(a.value.reservation_date)),a.value.check_in=a.value.check_in?l(a.value.check_in):null,i.post("/api/reserves/",a.value).then(e=>{console.log("Respuesta API create trip: ",e.data.message),s({icon:"success",title:"Reserva creada correctamente",text:e.data.message})}).catch(e=>{if(console.error("Error creando la reserva:",e),e.response)switch(e.response.status){case 422:e.response.data.message&&s({icon:"error",title:"Error",text:e.response.data.message});break;case 404:s({icon:"error",title:"Error",text:e.response.data.message||"Usuario o viaje no encontrado"});break;default:s({icon:"error",title:"Error",text:"Ha ocurrido un error al crear la reserva"})}else s({icon:"error",title:"Error",text:"Error de conexión. Por favor, inténtelo de nuevo"})}).finally(()=>r.value=!1))};function l(a){return a?new Date(a).toISOString().replace("T"," ").slice(0,19):null}return{reserveList:d,reserve:u,reserveSchema:p,validationErrors:t,isLoading:r,getReserves:m,getReserve:f,createReserve:g,updateReserve:async a=>{r.value||(r.value=!0,t.value={},a.value.pivot.reservation_date=l(a.value.pivot.reservation_date),a.value.pivot.check_in=l(a.value.pivot.check_in),i.put("/api/reserves/"+a.value.pivot.user_id+"/"+a.value.pivot.trip_id,a.value.pivot).then(e=>{console.log("Respuesta API update: ",e.data.message),s({icon:"success",title:"Reserva actualizada correctamente"})}).catch(e=>{if(console.error("Error creando la reserva:",e),e.response)switch(e.response.status){case 404:e.response.data.message&&s({icon:"error",title:"Error",text:e.response.data.message});break;default:s({icon:"error",title:"Error",text:"Ha ocurrido un error al crear la reserva"})}}).finally(()=>r.value=!1))},deleteReserve:async a=>{r.value||(r.value=!0,t.value={},i.delete("/api/reserves/"+a.user_id+"/"+a.trip_id).then(e=>{console.log("Respuesta API delete: ",e.data.message),s({icon:"success",title:"Reserva eliminada Correctamente"})}).catch(e=>{if(console.error("Error creando la reserva:",e),e.response)switch(e.response.status){case 404:e.response.data.message&&s({icon:"error",title:"Error",text:e.response.data.message});break;default:s({icon:"error",title:"Error",text:"Ha ocurrido un error al crear la reserva"})}}).finally(()=>r.value=!1))}}}export{I as u};
