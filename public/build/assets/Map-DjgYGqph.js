import{q as v,l as y,E as f,b as C,h,o as M}from"./app-pebjqkCD.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I={__name:"Map",props:{origin:Object,destination:Object},emits:["updateMapsInfo"],setup(g,{emit:m}){const o=g,p=m;v(()=>{var a,t,l,i,r,d,u,c;(t=(a=o.origin)==null?void 0:a.geometry)!=null&&t.location||(i=(l=o.destination)==null?void 0:l.geometry)!=null&&i.location?(e.value.mapCenter.lat=o.origin.geometry.location.lat(),e.value.mapCenter.lng=o.origin.geometry.location.lng(),e.value.destination.lat=o.destination.geometry.location.lat(),e.value.destination.lng=o.destination.geometry.location.lng(),s(),n(e.value.mapCenter,"D"),n(e.value.destination,"O")):(d=(r=o.origin)==null?void 0:r.location)!=null&&d.latitude&&((c=(u=o.origin)==null?void 0:u.location)!=null&&c.longitude)?(e.value.mapCenter.lat=o.origin.location.latitude,e.value.mapCenter.lng=o.origin.location.longitude,e.value.destination.lat=o.destination.location.latitude,e.value.destination.lng=o.destination.location.longitude,s(),n(e.value.mapCenter,"O"),n(e.value.destination,"D")):(s(),n(e.value.mapCenter,"O"))}),f(()=>[o.origin,o.destination],([a,t])=>{var l,i;(l=a==null?void 0:a.geometry)!=null&&l.location.lat&&((i=t==null?void 0:t.geometry)!=null&&i.location.lat)&&(e.value.mapCenter.lat=a.geometry.location.lat(),e.value.mapCenter.lng=a.geometry.location.lng(),e.value.destination.lat=t==null?void 0:t.geometry.location.lat(),e.value.destination.lng=t==null?void 0:t.geometry.location.lng(),s(),n(e.value.mapCenter,"O"),n(e.value.destination,"D"))});const e=y({map:null,mapCenter:{lat:41.41087625773037,lng:2.0270428374359217},destination:{lat:0,lng:0}}),s=()=>{e.value.map=new google.maps.Map(document.getElementById("map"),{center:e.value.mapCenter,maxZoom:20,minZoom:5,zoom:12,streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0,zoomControl:!0,disableDefaultUI:!0}),fetch("https://routes.googleapis.com/directions/v2:computeRoutes",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":"AIzaSyBTieKFaOBUuht1KZJeQ2NX0Izja8_G1ls","X-Goog-FieldMask":"routes.duration,routes.distanceMeters,routes.polyline.encodedPolyline"},body:JSON.stringify({origin:{location:{latLng:{latitude:e.value.mapCenter.lat,longitude:e.value.mapCenter.lng}}},destination:{location:{latLng:{latitude:e.value.destination.lat,longitude:e.value.destination.lng}}},travelMode:"DRIVE"})}).then(a=>a.json()).then(a=>{if(a.routes&&a.routes.length>0){const t=a.routes[0],l=google.maps.geometry.encoding.decodePath(t.polyline.encodedPolyline);new google.maps.Polyline({path:l,geodesic:!0,strokeColor:"#02aef8",strokeOpacity:1,strokeWeight:4}).setMap(e.value.map);const r=new google.maps.LatLngBounds;for(const u of l)r.extend(u);e.value.map.fitBounds(r);const d={origin:{address:o.origin.name,location:{latitude:o.origin.geometry.location.lat(),longitude:o.origin.geometry.location.lng()}},destination:{address:o.destination.name,location:{latitude:o.destination.geometry.location.lat(),longitude:o.destination.geometry.location.lng()}},distance:t.distanceMeters,duration:t.duration};p("updateMapsInfo",d)}}).catch(a=>console.error("Error al obtener la ruta: ",a))};function n(a,t){new google.maps.Marker({position:a,map:e.value.map,label:{text:t,color:"white"}})}return(a,t)=>(M(),C("div",null,t[0]||(t[0]=[h("div",{id:"map"},null,-1)])))}},B=_(I,[["__scopeId","data-v-181c5ca7"]]);export{B as M};
